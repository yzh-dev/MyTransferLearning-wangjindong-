

















100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 152/152 [00:37<00:00,  4.06it/s]
  0%|                                                                                                                                           | 0/273 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "D:\ML\Projects\MyTransferLearning-wangjindong-\code\Myclip\main.py", line 130, in <module>
    sweep(args.model, args.dataset)
  File "D:\ML\Projects\MyTransferLearning-wangjindong-\code\Myclip\main.py", line 123, in sweep
    main(args)
  File "D:\ML\Projects\MyTransferLearning-wangjindong-\code\Myclip\main.py", line 88, in main
    best_acc = clip.finetune(train_loader, test_loader, optimizer, args.nepoch, save_path='./log/{}_{}_{}.pt'.format(args.mode, model_name, dataset_name))
  File "D:\ML\Projects\MyTransferLearning-wangjindong-\code\Myclip\clip_model.py", line 157, in finetune
    eval_acc, _ = self.evaluate(testloader)
  File "D:\ML\Projects\MyTransferLearning-wangjindong-\code\Myclip\clip_model.py", line 179, in evaluate
    image_features = self.ImageAdapter(image_features)
  File "C:\ProgramData\Anaconda3\envs\mmlab\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "D:\ML\Projects\MyTransferLearning-wangjindong-\code\Myclip\clip_model.py", line 25, in forward
    a = self.fc(x)
  File "C:\ProgramData\Anaconda3\envs\mmlab\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\mmlab\lib\site-packages\torch\nn\modules\container.py", line 204, in forward
    input = module(input)
  File "C:\ProgramData\Anaconda3\envs\mmlab\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "C:\ProgramData\Anaconda3\envs\mmlab\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: expected scalar type Half but found Float
[1m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[1mmain.py 130 <module>
[1msweep(args.model, args.dataset)
[1mmain.py 123 sweep
[1mmain(args)
[1mmain.py 88 main
[1mbest_acc = clip.finetune(train_loader, test_loader, optimizer, args.nepoch, save_path='./log/{}_{}_{}.pt'.format(args.mode, model_name, dataset_name))
[1mclip_model.py 157 finetune
[1meval_acc, _ = self.evaluate(testloader)
[1mclip_model.py 179 evaluate
[1mimage_features = self.ImageAdapter(image_features)
[1mmodule.py 1194 _call_impl
[1mreturn forward_call(*input, **kwargs)
[1mclip_model.py 25 forward
[1ma = self.fc(x)
[1mmodule.py 1194 _call_impl
[1mreturn forward_call(*input, **kwargs)
[1mcontainer.py 204 forward
[1minput = module(input)
[1mmodule.py 1194 _call_impl
[1mreturn forward_call(*input, **kwargs)
[1mlinear.py 114 forward
[1mreturn F.linear(input, self.weight, self.bias)
[1mRuntimeError:
[1mexpected scalar type Half but found Float